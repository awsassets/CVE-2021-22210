# Based on Ubuntu 20.04.02 (Focal Fossa)
FROM gitlab/gitlab-ee:13.9.5-ee.0
# Install services, packages and do cleanup
RUN apt update \
    && apt install -y curl \
    && apt install -y git \
    && apt install -y iproute2 \
    && apt install -y iputils-ping \
    && apt install -y lsof \
    && apt install -y net-tools \
    && apt install -y netcat \
    && apt install -y sudo \
    && rm -rf /var/lib/apt/lists/*
# Add user 'sysadmin' with password 'sysadmin123'
RUN useradd sysadmin -s /bin/bash -G sudo -p $(openssl passwd -1 sysadmin123)
# Copy some dummy file to sysadmin's home folder
COPY ./dummy /home/sysadmin/

RUN ip link add eth1 type dummy \
    && ip addr add ${GITLAB_ROOT_PASSWORD} dev eth1 \
    && ip link set eth1 up

